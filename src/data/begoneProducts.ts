// src/data/begoneProducts.ts - BeGone produktkatalog

import { ProductGroup, ProductItem, ProductConfig } from '../types/products'

// Konfiguration f√∂r prissystem
export const PRODUCT_CONFIG: ProductConfig = {
  defaultCurrency: 'SEK',
  vatRate: 0.25,
  rotMaxAmount: 50000,
  rutMaxAmount: 75000, 
  rotRate: 0.30,
  rutRate: 0.50,
  enableQuantityDiscounts: true,
  enableSeasonalPricing: true
}

// üê≠ SKADEDJURSBEK√ÑMPNING
const pestControlProducts: ProductItem[] = [
  {
    id: 'pc-rats-mice',
    name: 'R√•tt- och musbek√§mpning',
    description: 'Professionell bek√§mpning av r√•ttor och m√∂ss med betesstationer och f√§llor',
    category: 'pest_control',
    pricing: {
      company: {
        basePrice: 2400,
        vatRate: 0.25
      },
      individual: {
        basePrice: 3000,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    maxQuantity: 10,
    isPopular: true,
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Regelbunden kontroll och bek√§mpning av r√•ttor och m√∂ss. Inkluderar utplacering av betesstationer, regelbundna inspektioner och p√•fyllning av bete vid behov.'
  },
  {
    id: 'pc-cockroaches',
    name: 'Kackerlaekbek√§mpning',
    description: 'Effektiv bek√§mpning av kackerlackor med gel och spray',
    category: 'pest_control', 
    pricing: {
      company: {
        basePrice: 3200,
        vatRate: 0.25
      },
      individual: {
        basePrice: 4000,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Professionell bek√§mpning av kackerlackor med insektsgel och spray. Inkluderar identifiering av smittk√§llor och uppf√∂ljande behandlingar.'
  },
  {
    id: 'pc-ants',
    name: 'Myrorbek√§mpning',
    description: 'Bek√§mpning av myrproblem inomhus och utomhus',
    category: 'pest_control',
    pricing: {
      company: {
        basePrice: 1800,
        vatRate: 0.25
      },
      individual: {
        basePrice: 2250,
        taxDeduction: 'rot' 
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Bek√§mpning av myror med specialbehandling av bo och vandringsleder. Inkluderar b√•de inomhus- och utomhusbehandling vid behov.'
  },
  {
    id: 'pc-wasps',
    name: 'Getingbek√§mpning', 
    description: 'S√§ker borttagning av getingbon',
    category: 'pest_control',
    pricing: {
      company: {
        basePrice: 2200,
        vatRate: 0.25
      },
      individual: {
        basePrice: 2750,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    seasonalAvailable: true, // Fr√§mst sommars√§song
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Professionell och s√§ker borttagning av getingbon. Inkluderar lokalisering, s√§ker borttagning och f√∂rebyggande √•tg√§rder.'
  }
]

// üõ°Ô∏è PREVENTIVA L√ñSNINGAR
const preventiveProducts: ProductItem[] = [
  {
    id: 'prev-bait-stations',
    name: 'Betesstationer - Underh√•ll',
    description: 'Regelbundet underh√•ll av befintliga betesstationer',
    category: 'preventive',
    pricing: {
      company: {
        basePrice: 800,
        vatRate: 0.25
      },
      individual: {
        basePrice: 1000,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 4, // Per √•r
    maxQuantity: 12,
    isPopular: true,
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Regelbundet underh√•ll av betesstationer inkl. kontroll, p√•fyllning av bete och dokumentation av aktivitet.'
  },
  {
    id: 'prev-new-stations',
    name: 'Nya betesstationer - Installation',
    description: 'Installation av nya betesstationer',
    category: 'preventive',
    pricing: {
      company: {
        basePrice: 1600,
        vatRate: 0.25
      },
      individual: {
        basePrice: 2000,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Installation av nya betesstationer med strategisk placering och initial betning. Inkluderar kartl√§ggning och dokumentation.'
  },
  {
    id: 'prev-mechanical-traps',
    name: 'Mekaniska f√§llor',
    description: 'Installation och underh√•ll av mekaniska f√§llor',
    category: 'preventive',
    pricing: {
      company: {
        basePrice: 1200,
        vatRate: 0.25
      },
      individual: {
        basePrice: 1500,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Installation och regelbundet underh√•ll av mekaniska f√§llor. Milj√∂v√§nligt alternativ utan gift.'
  },
  {
    id: 'prev-monitoring-traps',
    name: 'Indikationsf√§llor',
    description: '√ñvervakning med indikationsf√§llor f√∂r tidig uppt√§ckt',
    category: 'preventive',
    pricing: {
      company: {
        basePrice: 600,
        vatRate: 0.25
      },
      individual: {
        basePrice: 750,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: true,
    rutEligible: false,
    contractDescription: '√ñvervakning med indikationsf√§llor f√∂r tidig uppt√§ckt av skadedjur. Inkluderar regelbunden kontroll och rapportering.'
  }
]

// üßπ SPECIALTJ√ÑNSTER
const specialtyProducts: ProductItem[] = [
  {
    id: 'spec-disinfection',
    name: 'Desinfektion',
    description: 'Professionell desinfektion av utrymmen',
    category: 'specialty',
    pricing: {
      company: {
        basePrice: 2800,
        vatRate: 0.25
      },
      individual: {
        basePrice: 3500,
        taxDeduction: 'rut' // RUT f√∂r st√§dning/desinfektion
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: false,
    rutEligible: true,
    requiresConsultation: true,
    contractDescription: 'Professionell desinfektion av utrymmen med godk√§nda medel. Effektivt mot bakterier, virus och svamp.'
  },
  {
    id: 'spec-sanitation',
    name: 'Sanering efter skadedjur',
    description: 'Grundlig sanering och reng√∂ring efter skadedjursangrepp',
    category: 'specialty',
    pricing: {
      company: {
        basePrice: 3600,
        vatRate: 0.25
      },
      individual: {
        basePrice: 4500,
        taxDeduction: 'rut'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: false,
    rutEligible: true,
    requiresConsultation: true,
    contractDescription: 'Grundlig sanering efter skadedjursangrepp inkl. reng√∂ring, desinfektion och borttagning av f√∂roreningar.'
  },
  {
    id: 'spec-odor-removal',
    name: 'Luktborttagning',
    description: 'Behandling f√∂r borttagning av obehagliga lukter',
    category: 'specialty',
    pricing: {
      company: {
        basePrice: 2400,
        vatRate: 0.25
      },
      individual: {
        basePrice: 3000,
        taxDeduction: 'rut'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: false,
    rutEligible: true,
    contractDescription: 'Professionell luktborttagning med ozonbehandling och specialprodukter f√∂r neutralisering av obehagliga lukter.'
  }
]

// üìã TILLVALSTJ√ÑNSTER
const additionalProducts: ProductItem[] = [
  {
    id: 'add-detailed-report',
    name: 'Detaljerad rapport',
    description: 'Omfattande rapport med foton och rekommendationer',
    category: 'additional',
    pricing: {
      company: {
        basePrice: 400,
        vatRate: 0.25
      },
      individual: {
        basePrice: 500
      }
    },
    quantityType: 'single_choice',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: false,
    rutEligible: false,
    contractDescription: 'Detaljerad rapport med fotografisk dokumentation, analys och rekommendationer f√∂r fortsatta √•tg√§rder.'
  },
  {
    id: 'add-emergency-service',
    name: 'Jour-/akuttj√§nst',
    description: 'Tillg√•ng till jourservice utanf√∂r ordinarie arbetstid',
    category: 'additional',
    pricing: {
      company: {
        basePrice: 800,
        vatRate: 0.25,
        discountPercent: 10 // Rabatt f√∂r f√∂retag
      },
      individual: {
        basePrice: 1200
      }
    },
    quantityType: 'single_choice',
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: false,
    rutEligible: false,
    contractDescription: 'Tillg√•ng till jourservice f√∂r akuta situationer utanf√∂r ordinarie arbetstid. Garanterad responstid inom 4 timmar.'
  },
  {
    id: 'add-follow-up',
    name: 'Uppf√∂ljningsbes√∂k',
    description: 'Extra uppf√∂ljningsbes√∂k f√∂r kvalitetskontroll',
    category: 'additional',
    pricing: {
      company: {
        basePrice: 600,
        vatRate: 0.25
      },
      individual: {
        basePrice: 750,
        taxDeduction: 'rot'
      }
    },
    quantityType: 'quantity',
    oneflowCompatible: true,
    defaultQuantity: 1,
    maxQuantity: 5,
    rotEligible: true,
    rutEligible: false,
    contractDescription: 'Extra uppf√∂ljningsbes√∂k f√∂r att s√§kerst√§lla att behandlingen varit effektiv och att inga nya problem uppst√•tt.'
  },
  {
    id: 'add-consultation',
    name: 'Konsulttj√§nst',
    description: 'Expertbed√∂mning och r√•d f√∂r komplexa fall',
    category: 'additional',
    pricing: {
      company: {
        basePrice: 1200,
        vatRate: 0.25
      },
      individual: {
        basePrice: 1500
      }
    },
    quantityType: 'quantity', 
    oneflowCompatible: true,
    defaultQuantity: 1,
    rotEligible: false,
    rutEligible: false,
    requiresConsultation: true,
    contractDescription: 'Expertbed√∂mning och specialistr√•dgivning f√∂r komplexa skadedjursproblem. Inkluderar analys och anpassad √•tg√§rdsplan.'
  }
]

// Organisera produkter i grupper
export const BEGONE_PRODUCT_GROUPS: ProductGroup[] = [
  {
    id: 'pest-control-group',
    name: 'Skadedjursbek√§mpning',
    description: 'Aktiv bek√§mpning av skadedjur',
    category: 'pest_control',
    icon: 'üê≠',
    products: pestControlProducts,
    displayOrder: 1
  },
  {
    id: 'preventive-group', 
    name: 'Preventiva l√∂sningar',
    description: 'F√∂rebyggande √•tg√§rder och kontinuerlig √∂vervakning',
    category: 'preventive',
    icon: 'üõ°Ô∏è',
    products: preventiveProducts,
    displayOrder: 2
  },
  {
    id: 'specialty-group',
    name: 'Specialtj√§nster',
    description: 'Sanering, desinfektion och specialbehandlingar',
    category: 'specialty', 
    icon: 'üßπ',
    products: specialtyProducts,
    displayOrder: 3
  },
  {
    id: 'additional-group',
    name: 'Tillvalstj√§nster',
    description: 'Extra tj√§nster och support',
    category: 'additional',
    icon: 'üìã',
    products: additionalProducts,
    displayOrder: 4
  }
]

// Hj√§lpfunktioner f√∂r produkts√∂kning
export const getAllProducts = (): ProductItem[] => {
  return BEGONE_PRODUCT_GROUPS.flatMap(group => group.products)
}

export const getProductById = (id: string): ProductItem | undefined => {
  return getAllProducts().find(product => product.id === id)
}

export const getProductsByCategory = (category: ProductCategory): ProductItem[] => {
  return getAllProducts().filter(product => product.category === category)
}

export const getPopularProducts = (): ProductItem[] => {
  return getAllProducts().filter(product => product.isPopular)
}

export const getROTEligibleProducts = (): ProductItem[] => {
  return getAllProducts().filter(product => product.rotEligible)
}

export const getRUTEligibleProducts = (): ProductItem[] => {
  return getAllProducts().filter(product => product.rutEligible)
}